{"id":"../node_modules/aws-amplify-react/dist/Auth/Provider/withGoogle.js","dependencies":[{"name":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/Provider/withGoogle.js.map","includedInParent":true,"mtime":1552220008284},{"name":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/src/Auth/Provider/withGoogle.jsx","includedInParent":true,"mtime":1552220008284},{"name":"/home/pronoob/Desktop/SandBox/ReactSandBox/package.json","includedInParent":true,"mtime":1552223257578},{"name":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/package.json","includedInParent":true,"mtime":1552220008284},{"name":"react","loc":{"line":69,"column":22},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/Provider/withGoogle.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/react/index.js"},{"name":"@aws-amplify/core","loc":{"line":70,"column":21},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/Provider/withGoogle.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/@aws-amplify/core/lib/index.js"},{"name":"@aws-amplify/auth","loc":{"line":71,"column":21},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/Provider/withGoogle.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/@aws-amplify/auth/lib/index.js"},{"name":"../../Amplify-UI/Amplify-UI-Theme","loc":{"line":72,"column":33},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/Provider/withGoogle.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Amplify-UI/Amplify-UI-Theme.js"},{"name":"@aws-amplify/ui","loc":{"line":73,"column":19},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/Provider/withGoogle.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/@aws-amplify/ui/dist/aws-amplify-ui.js"},{"name":"../../Amplify-UI/Amplify-UI-Components-React","loc":{"line":74,"column":44},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/Provider/withGoogle.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Amplify-UI/Amplify-UI-Components-React.js"},{"name":"../common/constants","loc":{"line":75,"column":26},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/Provider/withGoogle.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/common/constants.js"}],"generated":{"js":"\"use strict\";\n/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = require(\"react\");\nvar react_1 = require(\"react\");\nvar core_1 = require(\"@aws-amplify/core\");\nvar auth_1 = require(\"@aws-amplify/auth\");\nvar Amplify_UI_Theme_1 = require(\"../../Amplify-UI/Amplify-UI-Theme\");\nvar ui_1 = require(\"@aws-amplify/ui\");\nvar Amplify_UI_Components_React_1 = require(\"../../Amplify-UI/Amplify-UI-Components-React\");\nvar constants_1 = require(\"../common/constants\");\nvar logger = new core_1.ConsoleLogger('withGoogle');\nfunction withGoogle(Comp) {\n    return /** @class */ (function (_super) {\n        __extends(class_1, _super);\n        function class_1(props) {\n            var _this = _super.call(this, props) || this;\n            _this.initGapi = _this.initGapi.bind(_this);\n            _this.signIn = _this.signIn.bind(_this);\n            _this.signOut = _this.signOut.bind(_this);\n            _this.federatedSignIn = _this.federatedSignIn.bind(_this);\n            _this.state = {};\n            return _this;\n        }\n        class_1.prototype.signIn = function () {\n            var _this = this;\n            var ga = window.gapi.auth2.getAuthInstance();\n            var onError = this.props.onError;\n            ga.signIn().then(function (googleUser) {\n                _this.federatedSignIn(googleUser);\n                var payload = {\n                    provider: constants_1.default.GOOGLE\n                };\n                try {\n                    localStorage.setItem(constants_1.default.AUTH_SOURCE_KEY, JSON.stringify(payload));\n                }\n                catch (e) {\n                    logger.debug('Failed to cache auth source into localStorage', e);\n                }\n            }, function (error) {\n                if (onError)\n                    onError(error);\n                else\n                    throw error;\n            });\n        };\n        class_1.prototype.federatedSignIn = function (googleUser) {\n            return __awaiter(this, void 0, void 0, function () {\n                var _a, id_token, expires_at, profile, user, onStateChange;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            _a = googleUser.getAuthResponse(), id_token = _a.id_token, expires_at = _a.expires_at;\n                            profile = googleUser.getBasicProfile();\n                            user = {\n                                email: profile.getEmail(),\n                                name: profile.getName(),\n                                picture: profile.getImageUrl(),\n                            };\n                            onStateChange = this.props.onStateChange;\n                            if (!auth_1.default ||\n                                typeof auth_1.default.federatedSignIn !== 'function' ||\n                                typeof auth_1.default.currentAuthenticatedUser !== 'function') {\n                                throw new Error('No Auth module found, please ensure @aws-amplify/auth is imported');\n                            }\n                            return [4 /*yield*/, auth_1.default.federatedSignIn('google', { token: id_token, expires_at: expires_at }, user)];\n                        case 1:\n                            _b.sent();\n                            return [4 /*yield*/, auth_1.default.currentAuthenticatedUser()];\n                        case 2:\n                            user = _b.sent();\n                            if (onStateChange) {\n                                onStateChange('signedIn', user);\n                            }\n                            return [2 /*return*/];\n                    }\n                });\n            });\n        };\n        class_1.prototype.signOut = function () {\n            var authInstance = window.gapi && window.gapi.auth2 ? window.gapi.auth2.getAuthInstance() : null;\n            if (!authInstance) {\n                return Promise.resolve();\n            }\n            authInstance.then(function (googleAuth) {\n                if (!googleAuth) {\n                    logger.debug('google Auth undefined');\n                    return Promise.resolve();\n                }\n                logger.debug('google signing out');\n                return googleAuth.signOut();\n            });\n        };\n        class_1.prototype.componentDidMount = function () {\n            var google_client_id = this.props.google_client_id;\n            var ga = window.gapi && window.gapi.auth2 ?\n                window.gapi.auth2.getAuthInstance() :\n                null;\n            if (google_client_id && !ga)\n                this.createScript();\n        };\n        class_1.prototype.createScript = function () {\n            var script = document.createElement('script');\n            script.src = 'https://apis.google.com/js/platform.js';\n            script.async = true;\n            script.onload = this.initGapi;\n            document.body.appendChild(script);\n        };\n        class_1.prototype.initGapi = function () {\n            logger.debug('init gapi');\n            var that = this;\n            var google_client_id = this.props.google_client_id;\n            var g = window.gapi;\n            g.load('auth2', function () {\n                g.auth2.init({\n                    client_id: google_client_id,\n                    scope: 'profile email openid'\n                });\n            });\n        };\n        class_1.prototype.render = function () {\n            var ga = window.gapi && window.gapi.auth2\n                ? window.gapi.auth2.getAuthInstance()\n                : null;\n            return React.createElement(Comp, __assign({}, this.props, { ga: ga, googleSignIn: this.signIn, googleSignOut: this.signOut }));\n        };\n        return class_1;\n    }(react_1.Component));\n}\nexports.default = withGoogle;\nvar Button = function (props) { return (React.createElement(Amplify_UI_Components_React_1.SignInButton, { id: ui_1.googleSignInButton, onClick: props.googleSignIn, theme: props.theme || Amplify_UI_Theme_1.default, variant: 'googleSignInButton' },\n    React.createElement(Amplify_UI_Components_React_1.SignInButtonIcon, { theme: props.theme || Amplify_UI_Theme_1.default },\n        React.createElement(\"svg\", { viewBox: \"0 0 256 262\", xmlns: \"http://ww0w.w3.org/2000/svg\", preserveAspectRatio: \"xMidYMid\" },\n            React.createElement(\"path\", { d: \"M255.878 133.451c0-10.734-.871-18.567-2.756-26.69H130.55v48.448h71.947c-1.45 12.04-9.283 30.172-26.69 42.356l-.244 1.622 38.755 30.023 2.685.268c24.659-22.774 38.875-56.282 38.875-96.027\", fill: \"#4285F4\" }),\n            React.createElement(\"path\", { d: \"M130.55 261.1c35.248 0 64.839-11.605 86.453-31.622l-41.196-31.913c-11.024 7.688-25.82 13.055-45.257 13.055-34.523 0-63.824-22.773-74.269-54.25l-1.531.13-40.298 31.187-.527 1.465C35.393 231.798 79.49 261.1 130.55 261.1\", fill: \"#34A853\" }),\n            React.createElement(\"path\", { d: \"M56.281 156.37c-2.756-8.123-4.351-16.827-4.351-25.82 0-8.994 1.595-17.697 4.206-25.82l-.073-1.73L15.26 71.312l-1.335.635C5.077 89.644 0 109.517 0 130.55s5.077 40.905 13.925 58.602l42.356-32.782\", fill: \"#FBBC05\" }),\n            React.createElement(\"path\", { d: \"M130.55 50.479c24.514 0 41.05 10.589 50.479 19.438l36.844-35.974C195.245 12.91 165.798 0 130.55 0 79.49 0 35.393 29.301 13.925 71.947l42.211 32.783c10.59-31.477 39.891-54.251 74.414-54.251\", fill: \"#EB4335\" }))),\n    React.createElement(Amplify_UI_Components_React_1.SignInButtonContent, { theme: props.theme || Amplify_UI_Theme_1.default }, core_1.I18n.get('Sign In with Google')))); };\nexports.GoogleButton = withGoogle(Button);\n"},"sourceMaps":{"js":{"version":3,"file":"withGoogle.js","sourceRoot":"","sources":["../../../src/Auth/Provider/withGoogle.jsx"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n\nimport * as React from 'react';\nimport { Component } from 'react';\n\nimport { I18n, ConsoleLogger as Logger } from '@aws-amplify/core';\nimport Auth from '@aws-amplify/auth';\nimport AmplifyTheme from '../../Amplify-UI/Amplify-UI-Theme';\nimport { googleSignInButton } from '@aws-amplify/ui';\nimport {\n    SignInButton,\n    SignInButtonIcon,\n    SignInButtonContent\n} from '../../Amplify-UI/Amplify-UI-Components-React';\nimport Constants from '../common/constants';\n\nconst logger = new Logger('withGoogle');\n\nexport default function withGoogle(Comp) {\n    return class extends Component {\n        constructor(props) {\n            super(props);\n\n            this.initGapi = this.initGapi.bind(this);\n            this.signIn = this.signIn.bind(this);\n            this.signOut = this.signOut.bind(this);\n            this.federatedSignIn = this.federatedSignIn.bind(this);\n\n            this.state = {};\n        }\n\n        signIn() {\n            const ga = window.gapi.auth2.getAuthInstance();\n            const { onError } = this.props;\n            ga.signIn().then(\n                googleUser => {\n                    this.federatedSignIn(googleUser);\n                    const payload = {\n                        provider: Constants.GOOGLE\n                    };\n\n                    try {\n                        localStorage.setItem(Constants.AUTH_SOURCE_KEY, JSON.stringify(payload));\n                    } catch (e) {\n                        logger.debug('Failed to cache auth source into localStorage', e);\n                    }\n                },\n                error => {\n                    if (onError) onError(error);\n                    else throw error;\n                }\n            );\n        }\n\n        async federatedSignIn(googleUser) {\n            const { id_token, expires_at } = googleUser.getAuthResponse();\n            const profile = googleUser.getBasicProfile();\n            let user = {\n                email: profile.getEmail(),\n                name: profile.getName(),\n                picture: profile.getImageUrl(),\n            };\n\n            const { onStateChange } = this.props;\n            if (!Auth || \n                typeof Auth.federatedSignIn !== 'function' || \n                typeof Auth.currentAuthenticatedUser !== 'function') {\n                throw new Error('No Auth module found, please ensure @aws-amplify/auth is imported');\n            }\n            \n            await Auth.federatedSignIn(\n                'google',\n                { token: id_token, expires_at },\n                user\n            );\n\n            user = await Auth.currentAuthenticatedUser();\n\n            if (onStateChange) {\n                onStateChange('signedIn', user);\n            }\n        }\n\n        signOut() {\n            const authInstance = window.gapi && window.gapi.auth2? window.gapi.auth2.getAuthInstance() : null;\n            if (!authInstance) {\n                return Promise.resolve();\n            }\n\n            authInstance.then((googleAuth) => {\n                if (!googleAuth) {\n                    logger.debug('google Auth undefined');\n                    return Promise.resolve();\n                }\n\n                logger.debug('google signing out');\n                return googleAuth.signOut();\n            });\n        }\n\n        componentDidMount() {\n            const { google_client_id } = this.props;\n            const ga = window.gapi && window.gapi.auth2 ? \n                window.gapi.auth2.getAuthInstance() : \n                null;\n            if (google_client_id && !ga) this.createScript();\n        }\n\n        createScript() {\n            const script = document.createElement('script');\n            script.src = 'https://apis.google.com/js/platform.js';\n            script.async = true;\n            script.onload = this.initGapi;\n            document.body.appendChild(script);\n        }\n\n        initGapi() {\n            logger.debug('init gapi');\n\n            const that = this;\n            const { google_client_id } = this.props;\n            const g = window.gapi;\n            g.load('auth2', function() {\n                g.auth2.init({\n                    client_id: google_client_id,\n                    scope: 'profile email openid'\n                });\n            });\n        }\n\n        render() {\n            const ga =\n                window.gapi && window.gapi.auth2\n                    ? window.gapi.auth2.getAuthInstance()\n                    : null;\n            return <Comp {...this.props} ga={ga} googleSignIn={this.signIn} googleSignOut={this.signOut} />;\n        }\n    };\n}\n\nconst Button = props => (\n    <SignInButton\n        id={googleSignInButton}\n        onClick={props.googleSignIn}\n        theme={props.theme || AmplifyTheme}\n        variant='googleSignInButton'\n    >\n        <SignInButtonIcon theme={props.theme || AmplifyTheme}>\n            <svg viewBox=\"0 0 256 262\" xmlns=\"http://ww0w.w3.org/2000/svg\" preserveAspectRatio=\"xMidYMid\"><path d=\"M255.878 133.451c0-10.734-.871-18.567-2.756-26.69H130.55v48.448h71.947c-1.45 12.04-9.283 30.172-26.69 42.356l-.244 1.622 38.755 30.023 2.685.268c24.659-22.774 38.875-56.282 38.875-96.027\" fill=\"#4285F4\"/><path d=\"M130.55 261.1c35.248 0 64.839-11.605 86.453-31.622l-41.196-31.913c-11.024 7.688-25.82 13.055-45.257 13.055-34.523 0-63.824-22.773-74.269-54.25l-1.531.13-40.298 31.187-.527 1.465C35.393 231.798 79.49 261.1 130.55 261.1\" fill=\"#34A853\"/><path d=\"M56.281 156.37c-2.756-8.123-4.351-16.827-4.351-25.82 0-8.994 1.595-17.697 4.206-25.82l-.073-1.73L15.26 71.312l-1.335.635C5.077 89.644 0 109.517 0 130.55s5.077 40.905 13.925 58.602l42.356-32.782\" fill=\"#FBBC05\"/><path d=\"M130.55 50.479c24.514 0 41.05 10.589 50.479 19.438l36.844-35.974C195.245 12.91 165.798 0 130.55 0 79.49 0 35.393 29.301 13.925 71.947l42.211 32.783c10.59-31.477 39.891-54.251 74.414-54.251\" fill=\"#EB4335\"/></svg>\n        </SignInButtonIcon>\n        <SignInButtonContent theme={props.theme || AmplifyTheme}>\n            {I18n.get('Sign In with Google')}\n        </SignInButtonContent>\n    </SignInButton>\n);\n\nexport const GoogleButton = withGoogle(Button);\n"]}},"error":null,"hash":"722c579a41c5026f8ff7f006915bb256","cacheData":{"env":{}}}