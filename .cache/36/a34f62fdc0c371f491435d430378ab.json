{"id":"../node_modules/aws-amplify-react/dist/Storage/S3Text.js","dependencies":[{"name":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/S3Text.js.map","includedInParent":true,"mtime":1552220008284},{"name":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/src/Storage/S3Text.js","includedInParent":true,"mtime":1552220008284},{"name":"/home/pronoob/Desktop/SandBox/ReactSandBox/package.json","includedInParent":true,"mtime":1552220018357},{"name":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/package.json","includedInParent":true,"mtime":1552220008284},{"name":"react","loc":{"line":26,"column":22},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/S3Text.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/react/index.js"},{"name":"@aws-amplify/core","loc":{"line":27,"column":21},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/S3Text.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/@aws-amplify/core/lib/index.js"},{"name":"@aws-amplify/storage","loc":{"line":28,"column":24},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/S3Text.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/@aws-amplify/storage/lib/index.js"},{"name":"../AmplifyTheme","loc":{"line":29,"column":29},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/S3Text.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/AmplifyTheme.js"},{"name":"../Widget/TextPicker","loc":{"line":30,"column":27},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/S3Text.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Widget/TextPicker.js"},{"name":"./Common","loc":{"line":31,"column":23},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/S3Text.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/Common.js"}],"generated":{"js":"\"use strict\";\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = require(\"react\");\nvar react_1 = require(\"react\");\nvar core_1 = require(\"@aws-amplify/core\");\nvar storage_1 = require(\"@aws-amplify/storage\");\nvar AmplifyTheme_1 = require(\"../AmplifyTheme\");\nvar TextPicker_1 = require(\"../Widget/TextPicker\");\nvar Common_1 = require(\"./Common\");\nvar logger = new core_1.ConsoleLogger('Storage.S3Text');\nvar S3Text = /** @class */ (function (_super) {\n    __extends(S3Text, _super);\n    function S3Text(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleOnLoad = _this.handleOnLoad.bind(_this);\n        _this.handleOnError = _this.handleOnError.bind(_this);\n        _this.handlePick = _this.handlePick.bind(_this);\n        _this.handleClick = _this.handleClick.bind(_this);\n        var text = props.text, textKey = props.textKey;\n        _this.state = {\n            text: text || '',\n            textKey: textKey || ''\n        };\n        return _this;\n    }\n    S3Text.prototype.getText = function (key, level, track, identityId) {\n        var _this = this;\n        if (!storage_1.default || typeof storage_1.default.get !== 'function') {\n            throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n        }\n        storage_1.default.get(key, { download: true, level: level ? level : 'public', track: track, identityId: identityId })\n            .then(function (data) {\n            logger.debug(data);\n            var text = data.Body.toString('utf8');\n            _this.setState({ text: text });\n            _this.handleOnLoad(text);\n        })\n            .catch(function (err) {\n            logger.debug(err);\n            _this.handleOnError(err);\n        });\n    };\n    S3Text.prototype.load = function () {\n        var _a = this.props, path = _a.path, textKey = _a.textKey, body = _a.body, contentType = _a.contentType, level = _a.level, track = _a.track, identityId = _a.identityId;\n        if (!textKey && !path) {\n            logger.debug('empty textKey and path');\n            return;\n        }\n        var that = this;\n        var key = textKey || path;\n        logger.debug('loading ' + key + '...');\n        if (body) {\n            var type = contentType || 'text/*';\n            if (!storage_1.default || typeof storage_1.default.put !== 'function') {\n                throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n            }\n            var ret = storage_1.default.put(key, body, {\n                contentType: type,\n                level: level ? level : 'public',\n                track: track\n            });\n            ret.then(function (data) {\n                logger.debug(data);\n                that.getText(key, level, track, identityId);\n            })\n                .catch(function (err) { return logger.debug(err); });\n        }\n        else {\n            that.getText(key, level, track, identityId);\n        }\n    };\n    S3Text.prototype.handleOnLoad = function (text) {\n        var onLoad = this.props.onLoad;\n        if (onLoad) {\n            onLoad(text);\n        }\n    };\n    S3Text.prototype.handleOnError = function (err) {\n        var onError = this.props.onError;\n        if (onError) {\n            onError(err);\n        }\n    };\n    S3Text.prototype.handlePick = function (data) {\n        var that = this;\n        var path = this.props.path || '';\n        var _a = this.props, textKey = _a.textKey, level = _a.level, fileToKey = _a.fileToKey, track = _a.track, identityId = _a.identityId;\n        var file = data.file, name = data.name, size = data.size, type = data.type;\n        var key = textKey || (path + Common_1.calcKey(data, fileToKey));\n        if (!storage_1.default || typeof storage_1.default.put !== 'function') {\n            throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n        }\n        storage_1.default.put(key, file, {\n            level: level ? level : 'public',\n            contentType: type,\n            track: track\n        })\n            .then(function (data) {\n            logger.debug('handle pick data', data);\n            that.getText(key, level, track, identityId);\n        })\n            .catch(function (err) { return logger.debug('handle pick error', err); });\n    };\n    S3Text.prototype.handleClick = function (evt) {\n        var onClick = this.props.onClick;\n        if (onClick) {\n            onClick(evt);\n        }\n    };\n    S3Text.prototype.componentDidMount = function () {\n        this.load();\n    };\n    S3Text.prototype.componentDidUpdate = function (prevProps) {\n        var update = prevProps.path !== this.props.path ||\n            prevProps.textKey !== this.props.textKey ||\n            prevProps.body !== this.props.body;\n        if (update) {\n            this.load();\n        }\n    };\n    S3Text.prototype.textEl = function (text, theme) {\n        if (!text) {\n            return null;\n        }\n        var selected = this.props.selected;\n        var containerStyle = { position: 'relative' };\n        return (React.createElement(\"div\", { style: containerStyle, onClick: this.handleClick },\n            React.createElement(\"pre\", { style: theme.pre }, text),\n            React.createElement(\"div\", { style: selected ? theme.overlaySelected : theme.overlay })));\n    };\n    S3Text.prototype.render = function () {\n        var _a = this.props, hidden = _a.hidden, style = _a.style, picker = _a.picker, translate = _a.translate, textKey = _a.textKey;\n        var text = this.state.text;\n        if (translate) {\n            text = (typeof translate === 'string') ? translate : translate({\n                type: 'text',\n                key: textKey,\n                content: text\n            });\n        }\n        if (!text && !picker) {\n            return null;\n        }\n        var theme = this.props.theme || AmplifyTheme_1.default;\n        var textStyle = hidden ? AmplifyTheme_1.default.hidden\n            : Object.assign({}, theme.text, style);\n        return (React.createElement(\"div\", { style: textStyle },\n            textStyle ? this.textEl(text, theme) : null,\n            picker ? React.createElement(\"div\", null,\n                React.createElement(TextPicker_1.default, { key: \"picker\", onPick: this.handlePick, theme: theme }))\n                : null));\n    };\n    return S3Text;\n}(react_1.Component));\nexports.default = S3Text;\n"},"sourceMaps":{"js":{"version":3,"file":"S3Text.js","sourceRoot":"","sources":["../../src/Storage/S3Text.js"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n\nimport * as React from 'react';\nimport { Component } from 'react';\n\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nimport Storage from '@aws-amplify/storage';\n\nimport AmplifyTheme from '../AmplifyTheme';\nimport TextPicker from '../Widget/TextPicker';\nimport { calcKey } from './Common';\n\nconst logger = new Logger('Storage.S3Text');\n\nexport default class S3Text extends Component {\n    constructor(props) {\n        super(props);\n\n        this.handleOnLoad = this.handleOnLoad.bind(this);\n        this.handleOnError = this.handleOnError.bind(this);\n        this.handlePick = this.handlePick.bind(this);\n        this.handleClick = this.handleClick.bind(this);\n\n        const { text, textKey } = props;\n        this.state = {\n            text: text || '',\n            textKey: textKey || ''\n        };\n    }\n\n    getText(key, level, track, identityId) {\n        if (!Storage || typeof Storage.get !== 'function') {\n            throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n        }\n        Storage.get(key, { download: true, level: level? level : 'public', track, identityId })\n            .then(data => {\n                logger.debug(data);\n                const text = data.Body.toString('utf8');\n                this.setState({ text });\n                this.handleOnLoad(text);\n            })\n            .catch(err => {\n                logger.debug(err);\n                this.handleOnError(err);\n            });\n    }\n\n    load() {\n        const { path, textKey, body, contentType, level, track, identityId } = this.props;\n        if (!textKey && !path) {\n            logger.debug('empty textKey and path');\n            return ;\n        }\n\n        const that = this;\n        const key = textKey || path;\n        logger.debug('loading ' + key + '...');\n        if (body) {\n            const type = contentType || 'text/*';\n            if (!Storage || typeof Storage.put !== 'function') {\n                throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n            }\n            const ret = Storage.put(key, body, {\n                contentType: type,\n                level: level? level : 'public',\n                track\n            });\n            ret.then(data => {\n                logger.debug(data);\n                that.getText(key, level, track, identityId);\n            })\n            .catch(err => logger.debug(err));\n        } else {\n            that.getText(key, level, track, identityId);\n        }\n    }\n\n    handleOnLoad(text) {\n        const { onLoad } = this.props;\n        if (onLoad) { onLoad(text); }\n    }\n\n    handleOnError(err) {\n        const { onError } = this.props;\n        if (onError) { onError(err); }\n    }\n\n    handlePick(data) {\n        const that = this;\n\n        const path = this.props.path || '';\n        const { textKey, level, fileToKey, track, identityId } = this.props;\n        const { file, name, size, type } = data;\n        const key = textKey || (path + calcKey(data, fileToKey));\n        if (!Storage || typeof Storage.put !== 'function') {\n            throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n        }\n        Storage.put(key, file, {\n            level: level? level: 'public',\n            contentType: type,\n            track\n        })\n            .then(data => {\n                logger.debug('handle pick data', data);\n                that.getText(key, level, track, identityId);\n            })\n            .catch(err => logger.debug('handle pick error', err));\n    }\n\n    handleClick(evt) {\n        const { onClick } = this.props;\n        if (onClick) { onClick(evt); }\n    }\n\n    componentDidMount() {\n        this.load();\n    }\n\n    componentDidUpdate(prevProps) {\n        const update = prevProps.path !== this.props.path ||\n                        prevProps.textKey !== this.props.textKey ||\n                        prevProps.body !== this.props.body\n        if (update) {\n            this.load();\n        }\n    }\n\n    textEl(text, theme) {\n        if (!text) { return null; }\n\n        const { selected } = this.props;\n        const containerStyle = { position: 'relative' };\n        return (\n            <div style={containerStyle} onClick={this.handleClick}>\n                <pre style={theme.pre}>{text}</pre>\n                <div style={selected? theme.overlaySelected : theme.overlay}></div>\n            </div>\n        );\n    }\n\n    render() {\n        const { hidden, style, picker, translate, textKey } = this.props;\n        let text = this.state.text;\n        if (translate) {\n            text = (typeof translate === 'string')? translate : translate({\n                type: 'text',\n                key: textKey,\n                content: text\n            });\n        }\n        if (!text && !picker) { return null; }\n\n        const theme = this.props.theme || AmplifyTheme;\n        const textStyle = hidden? AmplifyTheme.hidden\n                                : Object.assign({}, theme.text, style);\n\n        return (\n            <div style={textStyle}>\n                { textStyle? this.textEl(text, theme) : null }\n                { picker? <div>\n                              <TextPicker\n                                  key=\"picker\"\n                                  onPick={this.handlePick}\n                                  theme={theme}\n                              />\n                          </div>\n                        : null\n                }\n            </div>\n        );\n    }\n}\n"]}},"error":null,"hash":"2fd83679bd776db7d5e22bd76af15f74","cacheData":{"env":{}}}