{"id":"../node_modules/aws-amplify-react/dist/Auth/Provider/withAuth0.js","dependencies":[{"name":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/Provider/withAuth0.js.map","includedInParent":true,"mtime":1552220008284},{"name":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/src/Auth/Provider/withAuth0.jsx","includedInParent":true,"mtime":1552220008284},{"name":"/home/pronoob/Desktop/SandBox/ReactSandBox/package.json","includedInParent":true,"mtime":1552220018357},{"name":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/package.json","includedInParent":true,"mtime":1552220008284},{"name":"react","loc":{"line":69,"column":22},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/Provider/withAuth0.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/react/index.js"},{"name":"@aws-amplify/core","loc":{"line":70,"column":21},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/Provider/withAuth0.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/@aws-amplify/core/lib/index.js"},{"name":"@aws-amplify/auth","loc":{"line":71,"column":21},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/Provider/withAuth0.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/@aws-amplify/auth/lib/index.js"},{"name":"../../Amplify-UI/Amplify-UI-Theme","loc":{"line":72,"column":33},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/Provider/withAuth0.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Amplify-UI/Amplify-UI-Theme.js"},{"name":"@aws-amplify/ui","loc":{"line":74,"column":19},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/Provider/withAuth0.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/@aws-amplify/ui/dist/aws-amplify-ui.js"},{"name":"../../Amplify-UI/Amplify-UI-Components-React","loc":{"line":75,"column":44},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/Provider/withAuth0.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Amplify-UI/Amplify-UI-Components-React.js"},{"name":"../common/constants","loc":{"line":76,"column":26},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/Provider/withAuth0.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Auth/common/constants.js"}],"generated":{"js":"\"use strict\";\n/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = require(\"react\");\nvar react_1 = require(\"react\");\nvar core_1 = require(\"@aws-amplify/core\");\nvar auth_1 = require(\"@aws-amplify/auth\");\nvar Amplify_UI_Theme_1 = require(\"../../Amplify-UI/Amplify-UI-Theme\");\n// import auth0 from 'auth0-js';\nvar ui_1 = require(\"@aws-amplify/ui\");\nvar Amplify_UI_Components_React_1 = require(\"../../Amplify-UI/Amplify-UI-Components-React\");\nvar constants_1 = require(\"../common/constants\");\nvar logger = new core_1.ConsoleLogger('withAuth0');\nfunction withAuth0(Comp, options) {\n    return /** @class */ (function (_super) {\n        __extends(class_1, _super);\n        function class_1(props) {\n            var _this = _super.call(this, props) || this;\n            _this._auth0 = null;\n            _this.initialize = _this.initialize.bind(_this);\n            _this.signIn = _this.signIn.bind(_this);\n            _this.signOut = _this.signOut.bind(_this);\n            return _this;\n        }\n        class_1.prototype.componentDidMount = function () {\n            if (!window.auth0) {\n                this.createScript();\n            }\n            else {\n                this.initialize();\n            }\n        };\n        class_1.prototype.createScript = function () {\n            var script = document.createElement('script');\n            script.src = 'https://cdn.auth0.com/js/auth0/9.8.1/auth0.min.js';\n            script.async = true;\n            script.onload = this.initialize;\n            document.body.appendChild(script);\n        };\n        class_1.prototype.initialize = function () {\n            var _this = this;\n            var _a = auth_1.default.configure().oauth, oauth = _a === void 0 ? {} : _a;\n            var config = this.props.auth0 || options || oauth.auth0;\n            var _b = this.props, onError = _b.onError, onStateChange = _b.onStateChange, authState = _b.authState, onAuthEvent = _b.onAuthEvent;\n            if (!config) {\n                logger.debug('Auth0 is not configured');\n                return;\n            }\n            logger.debug('withAuth0 configuration', config);\n            if (!this._auth0) {\n                this._auth0 = new window['auth0'].WebAuth(config);\n                window.auth0_client = this._auth0;\n            }\n            if (authState !== 'signedIn') {\n                this._auth0.parseHash(function (err, authResult) {\n                    if (err || !authResult) {\n                        logger.debug('Failed to parse the url for Auth0', err);\n                        return;\n                    }\n                    var payload = {\n                        provider: constants_1.default.AUTH0,\n                        opts: {\n                            returnTo: config.returnTo,\n                            clientID: config.clientID,\n                            federated: config.federated\n                        }\n                    };\n                    try {\n                        localStorage.setItem(constants_1.default.AUTH_SOURCE_KEY, JSON.stringify(payload));\n                    }\n                    catch (e) {\n                        logger.debug('Failed to cache auth source into localStorage', e);\n                    }\n                    _this._auth0.client.userInfo(authResult.accessToken, function (err, user) {\n                        var username = undefined;\n                        var email = undefined;\n                        if (err) {\n                            logger.debug('Failed to get the user info', err);\n                        }\n                        else {\n                            username = user.name;\n                            email = user.email;\n                        }\n                        auth_1.default.federatedSignIn(config.domain, {\n                            token: authResult.idToken,\n                            expires_at: authResult.expiresIn * 1000 + new Date().getTime()\n                        }, { name: username, email: email }).then(function (cred) {\n                            if (onStateChange) {\n                                auth_1.default.currentAuthenticatedUser().then(function (user) {\n                                    onStateChange('signedIn', user);\n                                });\n                            }\n                        }).catch(function (e) {\n                            logger.debug('Failed to get the aws credentials', e);\n                            if (onError)\n                                onError(e);\n                        });\n                    });\n                });\n            }\n        };\n        class_1.prototype.signIn = function () {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    if (this._auth0)\n                        this._auth0.authorize();\n                    else {\n                        throw new Error('the auth0 client is not configured');\n                    }\n                    return [2 /*return*/];\n                });\n            });\n        };\n        class_1.prototype.signOut = function (opts) {\n            if (opts === void 0) { opts = {}; }\n            var auth0 = window.auth0_client;\n            var returnTo = opts.returnTo, clientID = opts.clientID, federated = opts.federated;\n            if (!auth0) {\n                logger.debug('auth0 sdk undefined');\n                return Promise.resolve();\n            }\n            auth0.logout({\n                returnTo: returnTo,\n                clientID: clientID,\n                federated: federated\n            });\n        };\n        class_1.prototype.render = function () {\n            return React.createElement(Comp, __assign({}, this.props, { auth0: this._auth0, auth0SignIn: this.signIn, auth0SignOut: this.signOut }));\n        };\n        return class_1;\n    }(react_1.Component));\n}\nexports.default = withAuth0;\nvar Button = function (props) { return (React.createElement(Amplify_UI_Components_React_1.SignInButton, { id: ui_1.auth0SignInButton, onClick: props.auth0SignIn, theme: props.theme || Amplify_UI_Theme_1.default, variant: 'auth0SignInButton' },\n    React.createElement(Amplify_UI_Components_React_1.SignInButtonIcon, { theme: props.theme || Amplify_UI_Theme_1.default },\n        React.createElement(\"svg\", { id: 'artwork', xmlns: 'http://www.w3.org/2000/svg', viewBox: '0 0 193.7 216.6' },\n            React.createElement(\"path\", { id: 'NEW', className: 'st0', d: 'M189,66.9L167.2,0H96.8l21.8,66.9H189z M96.8,0H26.5L4.8,66.9h70.4L96.8,0z M4.8,66.9L4.8,66.9\\tc-13,39.9,1.2,83.6,35.2,108.3l21.7-66.9L4.8,66.9z M189,66.9L189,66.9l-57,41.4l21.7,66.9l0,0C187.7,150.6,201.9,106.8,189,66.9\\tL189,66.9z M39.9,175.2L39.9,175.2l56.9,41.4l56.9-41.4l-56.9-41.4L39.9,175.2z' }))),\n    React.createElement(Amplify_UI_Components_React_1.SignInButtonContent, { theme: props.theme || Amplify_UI_Theme_1.default }, props.label || 'Sign In with Auth0'))); };\nexports.Auth0Button = withAuth0(Button);\n"},"sourceMaps":{"js":{"version":3,"file":"withAuth0.js","sourceRoot":"","sources":["../../../src/Auth/Provider/withAuth0.jsx"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n\n import * as React from 'react';\n import { Component } from 'react';\n\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nimport Auth from '@aws-amplify/auth';\nimport AmplifyTheme from '../../Amplify-UI/Amplify-UI-Theme';\n// import auth0 from 'auth0-js';\nimport { auth0SignInButton } from '@aws-amplify/ui';\nimport {\n    SignInButton,\n    SignInButtonIcon,\n    SignInButtonContent\n} from '../../Amplify-UI/Amplify-UI-Components-React';\nimport Constants from '../common/constants';\n\n\nconst logger = new Logger('withAuth0');\n\nexport default function withAuth0(Comp, options) {\n    return class extends Component {\n        constructor(props) {\n            super(props);\n            this._auth0 = null;\n\n            this.initialize = this.initialize.bind(this);\n            this.signIn = this.signIn.bind(this);\n            this.signOut = this.signOut.bind(this);\n        }\n\n        componentDidMount() {\n            if (!window.auth0) {\n                this.createScript();\n            } else {\n                this.initialize();\n            }\n        }\n\n        createScript() {\n            const script = document.createElement('script');\n            script.src = 'https://cdn.auth0.com/js/auth0/9.8.1/auth0.min.js';\n            script.async = true;\n            script.onload = this.initialize;\n            document.body.appendChild(script);\n        }\n\n        initialize() {\n            const { oauth = {} } = Auth.configure();\n            const config = this.props.auth0 || options || oauth.auth0;\n            const { onError, onStateChange, authState, onAuthEvent } = this.props;\n            if (!config) {\n                logger.debug('Auth0 is not configured');\n                return;\n            }\n\n            logger.debug('withAuth0 configuration', config);\n\n            if (!this._auth0) {\n                this._auth0 = new window['auth0'].WebAuth(config);\n                window.auth0_client = this._auth0;\n            }\n            \n            if (authState !== 'signedIn') {\n                this._auth0.parseHash((err, authResult) => {\n                    if (err || !authResult) {\n                        logger.debug('Failed to parse the url for Auth0', err);\n                        return;\n                    }\n                    const payload = {\n                        provider: Constants.AUTH0,\n                        opts: {\n                            returnTo: config.returnTo,\n                            clientID: config.clientID,\n                            federated: config.federated\n                        }\n                    };\n\n                    try {\n                        localStorage.setItem(Constants.AUTH_SOURCE_KEY, JSON.stringify(payload));\n                    } catch (e) {\n                        logger.debug('Failed to cache auth source into localStorage', e);\n                    }\n              \n                    this._auth0.client.userInfo(authResult.accessToken, (err, user) => {\n                        let username = undefined;\n                        let email = undefined;\n                        if (err) {\n                            logger.debug('Failed to get the user info', err);\n                        } else {\n                            username = user.name;\n                            email = user.email;\n                        }\n\n                        Auth.federatedSignIn(\n                            config.domain,\n                            {\n                                token: authResult.idToken,\n                                expires_at: authResult.expiresIn * 1000 + new Date().getTime()\n                            },\n                            { name: username, email }\n                        ).then((cred) => {\n                            if (onStateChange) {\n                                Auth.currentAuthenticatedUser().then(user => {\n                                    onStateChange('signedIn', user);\n                                });\n                            }\n                        }).catch((e) => {\n                            logger.debug('Failed to get the aws credentials', e);\n                            if (onError) onError(e);\n                        });\n                    });\n                });\n            }\n        }\n\n        async signIn() {\n            if (this._auth0) this._auth0.authorize();\n            else {\n                throw new Error('the auth0 client is not configured');\n            }\n        }\n\n        signOut(opts={}) {\n            const auth0 = window.auth0_client;\n            const { returnTo, clientID, federated } = opts;\n            if (!auth0) {\n                logger.debug('auth0 sdk undefined');\n                return Promise.resolve();\n            }\n            auth0.logout({\n                returnTo,\n                clientID,\n                federated\n            });\n        }\n\n        render() {\n            return <Comp {...this.props} auth0={this._auth0} auth0SignIn={this.signIn} auth0SignOut={this.signOut}/>;\n        }\n    };\n}\n\nconst Button = props => (\n    <SignInButton\n        id={auth0SignInButton}\n        onClick={props.auth0SignIn}\n        theme={props.theme || AmplifyTheme}\n        variant={'auth0SignInButton'}\n    >\n        <SignInButtonIcon theme={props.theme || AmplifyTheme}>\n            <svg id='artwork' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 193.7 216.6'>\n                <path id='NEW' className='st0' d='M189,66.9L167.2,0H96.8l21.8,66.9H189z M96.8,0H26.5L4.8,66.9h70.4L96.8,0z M4.8,66.9L4.8,66.9\tc-13,39.9,1.2,83.6,35.2,108.3l21.7-66.9L4.8,66.9z M189,66.9L189,66.9l-57,41.4l21.7,66.9l0,0C187.7,150.6,201.9,106.8,189,66.9\tL189,66.9z M39.9,175.2L39.9,175.2l56.9,41.4l56.9-41.4l-56.9-41.4L39.9,175.2z'/>\n            </svg>\n        </SignInButtonIcon>\n        <SignInButtonContent theme={props.theme || AmplifyTheme}>\n            {props.label || 'Sign In with Auth0'}\n        </SignInButtonContent>\n    </SignInButton>\n);\n\nexport const Auth0Button = withAuth0(Button);\n"]}},"error":null,"hash":"23b0179c5a519ca5876a4b937806af4c","cacheData":{"env":{}}}