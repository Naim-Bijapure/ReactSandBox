{"id":"../node_modules/aws-amplify-react/dist/Storage/S3Image.js","dependencies":[{"name":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/S3Image.js.map","includedInParent":true,"mtime":1552220008284},{"name":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/src/Storage/S3Image.js","includedInParent":true,"mtime":1552220008284},{"name":"/home/pronoob/Desktop/SandBox/ReactSandBox/package.json","includedInParent":true,"mtime":1552223257578},{"name":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/package.json","includedInParent":true,"mtime":1552220008284},{"name":"react","loc":{"line":26,"column":22},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/S3Image.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/react/index.js"},{"name":"@aws-amplify/core","loc":{"line":27,"column":21},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/S3Image.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/@aws-amplify/core/lib/index.js"},{"name":"@aws-amplify/storage","loc":{"line":28,"column":24},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/S3Image.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/@aws-amplify/storage/lib/index.js"},{"name":"../AmplifyTheme","loc":{"line":29,"column":29},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/S3Image.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/AmplifyTheme.js"},{"name":"../AmplifyUI","loc":{"line":30,"column":26},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/S3Image.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/AmplifyUI.js"},{"name":"../Widget/PhotoPicker","loc":{"line":31,"column":28},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/S3Image.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Widget/PhotoPicker.js"},{"name":"./Common","loc":{"line":32,"column":23},"parent":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/S3Image.js","resolved":"/home/pronoob/Desktop/SandBox/ReactSandBox/node_modules/aws-amplify-react/dist/Storage/Common.js"}],"generated":{"js":"\"use strict\";\n/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = require(\"react\");\nvar react_1 = require(\"react\");\nvar core_1 = require(\"@aws-amplify/core\");\nvar storage_1 = require(\"@aws-amplify/storage\");\nvar AmplifyTheme_1 = require(\"../AmplifyTheme\");\nvar AmplifyUI_1 = require(\"../AmplifyUI\");\nvar PhotoPicker_1 = require(\"../Widget/PhotoPicker\");\nvar Common_1 = require(\"./Common\");\nvar logger = new core_1.ConsoleLogger('Storage.S3Image');\nvar S3Image = /** @class */ (function (_super) {\n    __extends(S3Image, _super);\n    function S3Image(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleOnLoad = _this.handleOnLoad.bind(_this);\n        _this.handleOnError = _this.handleOnError.bind(_this);\n        _this.handlePick = _this.handlePick.bind(_this);\n        _this.handleClick = _this.handleClick.bind(_this);\n        var initSrc = _this.props.src || AmplifyUI_1.transparent1X1;\n        _this.state = { src: initSrc };\n        return _this;\n    }\n    S3Image.prototype.getImageSource = function (key, level, track, identityId) {\n        var _this = this;\n        if (!storage_1.default || typeof storage_1.default.get !== 'function') {\n            throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n        }\n        storage_1.default.get(key, { level: level ? level : 'public', track: track, identityId: identityId })\n            .then(function (url) {\n            _this.setState({\n                src: url\n            });\n        })\n            .catch(function (err) { return logger.debug(err); });\n    };\n    S3Image.prototype.load = function () {\n        var _a = this.props, imgKey = _a.imgKey, path = _a.path, body = _a.body, contentType = _a.contentType, level = _a.level, track = _a.track, identityId = _a.identityId;\n        if (!imgKey && !path) {\n            logger.debug('empty imgKey and path');\n            return;\n        }\n        var that = this;\n        var key = imgKey || path;\n        logger.debug('loading ' + key + '...');\n        if (body) {\n            var type = contentType || 'binary/octet-stream';\n            if (!storage_1.default || typeof storage_1.default.put !== 'function') {\n                throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n            }\n            var ret = storage_1.default.put(key, body, {\n                contentType: type,\n                level: level ? level : 'public',\n                track: track\n            });\n            ret.then(function (data) {\n                logger.debug(data);\n                that.getImageSource(key, level, track, identityId);\n            })\n                .catch(function (err) { return logger.debug(err); });\n        }\n        else {\n            that.getImageSource(key, level, track, identityId);\n        }\n    };\n    S3Image.prototype.handleOnLoad = function (evt) {\n        var onLoad = this.props.onLoad;\n        if (onLoad) {\n            onLoad(this.state.src);\n        }\n    };\n    S3Image.prototype.handleOnError = function (evt) {\n        var onError = this.props.onError;\n        if (onError) {\n            onError(this.state.src);\n        }\n    };\n    S3Image.prototype.handlePick = function (data) {\n        var that = this;\n        var path = this.props.path || '';\n        var _a = this.props, imgKey = _a.imgKey, level = _a.level, fileToKey = _a.fileToKey, track = _a.track, identityId = _a.identityId;\n        var file = data.file, name = data.name, size = data.size, type = data.type;\n        var key = imgKey || (path + Common_1.calcKey(data, fileToKey));\n        if (!storage_1.default || typeof storage_1.default.put !== 'function') {\n            throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n        }\n        storage_1.default.put(key, file, {\n            level: level ? level : 'public',\n            contentType: type,\n            track: track\n        })\n            .then(function (data) {\n            logger.debug('handle pick data', data);\n            that.getImageSource(key, level, track, identityId);\n        })\n            .catch(function (err) { return logger.debug('handle pick error', err); });\n    };\n    S3Image.prototype.handleClick = function (evt) {\n        var onClick = this.props.onClick;\n        if (onClick) {\n            onClick(evt);\n        }\n    };\n    S3Image.prototype.componentDidMount = function () {\n        this.load();\n    };\n    S3Image.prototype.componentDidUpdate = function (prevProps) {\n        var update = prevProps.path !== this.props.path ||\n            prevProps.imgKey !== this.props.imgKey ||\n            prevProps.body !== this.props.body;\n        if (update) {\n            this.load();\n        }\n    };\n    S3Image.prototype.imageEl = function (src, theme) {\n        if (!src) {\n            return null;\n        }\n        var selected = this.props.selected;\n        var containerStyle = { position: 'relative' };\n        return (React.createElement(\"div\", { style: containerStyle, onClick: this.handleClick },\n            React.createElement(\"img\", { style: theme.photoImg, src: src, onLoad: this.handleOnLoad, onError: this.handleOnError }),\n            React.createElement(\"div\", { style: selected ? theme.overlaySelected : theme.overlay })));\n    };\n    S3Image.prototype.render = function () {\n        var _a = this.props, hidden = _a.hidden, style = _a.style, picker = _a.picker, translate = _a.translate, imgKey = _a.imgKey;\n        var src = this.state.src;\n        if (translate) {\n            src = (typeof translate === 'string') ? translate : translate({\n                type: 'image',\n                key: imgKey,\n                content: src\n            });\n        }\n        if (!src && !picker) {\n            return null;\n        }\n        var theme = this.props.theme || AmplifyTheme_1.default;\n        var photoStyle = hidden ? AmplifyTheme_1.default.hidden\n            : Object.assign({}, theme.photo, style);\n        return (React.createElement(\"div\", { style: photoStyle },\n            photoStyle ? this.imageEl(src, theme) : null,\n            picker ? React.createElement(\"div\", null,\n                React.createElement(PhotoPicker_1.default, { key: \"picker\", onPick: this.handlePick, theme: theme })) : null));\n    };\n    return S3Image;\n}(react_1.Component));\nexports.default = S3Image;\n"},"sourceMaps":{"js":{"version":3,"file":"S3Image.js","sourceRoot":"","sources":["../../src/Storage/S3Image.js"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright 2017-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n\nimport * as React from 'react';\nimport { Component } from 'react';\n\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nimport Storage from '@aws-amplify/storage';\n\nimport AmplifyTheme from '../AmplifyTheme';\nimport { transparent1X1 } from '../AmplifyUI';\nimport PhotoPicker from '../Widget/PhotoPicker';\nimport { calcKey } from './Common';\n\nconst logger = new Logger('Storage.S3Image');\n\nexport default class S3Image extends Component {\n    constructor(props) {\n        super(props);\n\n        this.handleOnLoad = this.handleOnLoad.bind(this);\n        this.handleOnError = this.handleOnError.bind(this);\n        this.handlePick = this.handlePick.bind(this);\n        this.handleClick = this.handleClick.bind(this);\n\n        const initSrc = this.props.src || transparent1X1;\n\n        this.state = { src: initSrc };\n    }\n\n    getImageSource(key, level, track, identityId) {\n        if (!Storage || typeof Storage.get !== 'function') {\n            throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n        }\n        Storage.get(key, { level: level? level : 'public', track, identityId })\n            .then(url => {\n                this.setState({\n                    src: url\n                });\n            })\n            .catch(err => logger.debug(err));\n    }\n\n    load() {\n        const { imgKey, path, body, contentType, level, track, identityId } = this.props;\n        if (!imgKey && !path) {\n            logger.debug('empty imgKey and path');\n            return ;\n        }\n\n        const that = this;\n        const key = imgKey || path;\n        logger.debug('loading ' + key + '...');\n        if (body) {\n            const type = contentType || 'binary/octet-stream';\n            if (!Storage || typeof Storage.put !== 'function') {\n                throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n            }\n            const ret = Storage.put(key, body, {\n                contentType: type,\n                level: level? level : 'public',\n                track\n            });\n            ret.then(data => {\n                logger.debug(data);\n                that.getImageSource(key, level, track, identityId);\n            })\n            .catch(err => logger.debug(err));\n        } else {\n            that.getImageSource(key, level, track, identityId);\n        }\n    }\n\n    handleOnLoad(evt) {\n        const { onLoad } = this.props;\n        if (onLoad) { onLoad(this.state.src); }\n    }\n\n    handleOnError(evt) {\n        const { onError } = this.props;\n        if (onError) { onError(this.state.src); }\n    }\n\n    handlePick(data) {\n        const that = this;\n\n        const path = this.props.path || '';\n        const { imgKey, level, fileToKey, track, identityId } = this.props;\n        const { file, name, size, type } = data;\n        const key = imgKey || (path + calcKey(data, fileToKey));\n        if (!Storage || typeof Storage.put !== 'function') {\n            throw new Error('No Storage module found, please ensure @aws-amplify/storage is imported');\n        }\n        Storage.put(key, file, { \n            level: level? level: 'public',\n            contentType: type, \n            track \n        })\n            .then(data => {\n                logger.debug('handle pick data', data);\n                that.getImageSource(key, level, track, identityId);\n            })\n            .catch(err => logger.debug('handle pick error', err));\n    }\n\n    handleClick(evt) {\n        const { onClick } = this.props;\n        if (onClick) { onClick(evt); }\n    }\n\n    componentDidMount() {\n        this.load();\n    }\n\n    componentDidUpdate(prevProps) {\n        const update = prevProps.path !== this.props.path ||\n                        prevProps.imgKey !== this.props.imgKey ||\n                        prevProps.body !== this.props.body;\n        if (update) {\n            this.load();\n        }\n    }\n\n    imageEl(src, theme) {\n        if (!src) { return null; }\n\n        const { selected } = this.props;\n        const containerStyle = { position: 'relative' };\n        return (\n            <div style={containerStyle} onClick={this.handleClick}>\n                <img\n                    style={theme.photoImg}\n                    src={src}\n                    onLoad={this.handleOnLoad}\n                    onError={this.handleOnError}\n                />\n                <div style={selected? theme.overlaySelected : theme.overlay}></div>\n            </div>\n        );\n    }\n\n    render() {\n        const { hidden, style, picker, translate, imgKey } = this.props;\n        let src = this.state.src;\n        if (translate) {\n            src = (typeof translate === 'string')? translate : translate({\n                type: 'image',\n                key: imgKey,\n                content: src\n            });\n        }\n        if (!src && !picker) { return null; }\n\n        const theme = this.props.theme || AmplifyTheme;\n        const photoStyle = hidden? AmplifyTheme.hidden\n                                 : Object.assign({}, theme.photo, style);\n\n        return (\n            <div style={photoStyle}>\n                { photoStyle? this.imageEl(src, theme): null }\n                { picker? <div>\n                              <PhotoPicker\n                                  key=\"picker\"\n                                  onPick={this.handlePick}\n                                  theme={theme}\n                              />\n                          </div> : null\n                }\n            </div>\n        );\n    }\n}\n"]}},"error":null,"hash":"ab6989d373c5edfbe9ec65f24a8215f2","cacheData":{"env":{}}}